<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Local Attractions - Travel Companion</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="header">Local Attractions</div>
  <div class="content">
    <h2>Discover Amazing Places</h2>
    <div style="margin: 20px;">
      <button onclick="loadAttractionsFromExcel()">Load from Excel (Demo)</button>
    </div>
    <label for="sortSelect">Sort by:</label>
    <select id="sortSelect" onchange="loadAttractions()">
      <option value="default">Default</option>
      <option value="price">Price</option>
      <option value="rating">Rating</option>
    </select>
    <div class="attraction-list" id="attractionList"></div>
    <div class="back-btn"><a href="homepage.html">Back to Homepage</a></div>
  </div>
  <script src="common.js"></script>
  <script src="excelFunctions.js"></script>
  <script>
    function loadAttractions() {
      let container = document.getElementById("attractionList");
      let existingData = JSON.parse(localStorage.getItem("attractions")) || [];
      if (existingData.length === 0) { container.innerHTML = "<p>No attractions available.</p>"; return; }
      let sortOption = document.getElementById("sortSelect").value;
      if (sortOption === "price") { existingData.sort((a, b) => Number(a.Price || 0) - Number(b.Price || 0)); }
      else if (sortOption === "rating") { existingData.sort((a, b) => Number(b.Rating || 0) - Number(a.Rating || 0)); }
      container.innerHTML = "";
      existingData.forEach(item => {
        let div = document.createElement("div");
        div.className = "attraction-item";
        div.textContent = item.Info;
        container.appendChild(div);
      });
    }
    window.onload = loadAttractions;
  </script>
</body>
</html>
